"use strict";var normalize=function(t){var e=d3.time.format("%Y-%m-%d"),i=e.parse,a=0;t.forEach(function(t){t.id=a++,t.from=i(t.from),null===t.to?t.pto=new Date:(t.to=i(t.to),t.pto=t.to)})},calculateDiameter=function(t,e){t.forEach(function(t){t.diameter=e(t.pto)-e(t.from),null===t.to&&(t.diameter=2*t.diameter)}),t.sort(function(t,e){return e.diameter-t.diameter})},getPath=function(t,e){var i=t/2,a=e*(100+.7*i);return"M0,0 q "+i+" "+a+" "+t+" 0 z"},showInfo=function(t){d3.selectAll("div.cv").transition().style("opacity","0").style("z-index",0),d3.selectAll("div."+t).transition().style("opacity","1").style("z-index",100)},drawPaths=function(t,e,i,a,o,n){t.selectAll("path."+i).data(e).enter().append("path").classed(i,!0).attr("fill",function(t,e){return n(a*e)}).attr("fill-opacity",.6).attr("d",function(t){return getPath(t.diameter,a)}).attr("transform",function(t){return"translate("+[o(t.from),0]+")"}).on("mouseover",function(e){t.selectAll("path.item").transition(),d3.select(this).transition().attr("stroke-width","2").attr("fill-opacity",1),showInfo(e.class)}).on("mouseout",function(){t.selectAll("path.item").transition(),d3.select(this).transition().attr("stroke-width","1").attr("fill-opacity",.6)})},data=[[{type:"Work",institution:"Glan Ceirw Caravan Park","class":"glanceirw",title:"Web Developer",from:"2011-06-01",to:"2011-09-01",description:"",default_item:!1},{type:"Work",institution:"Ohal Ltd","class":"ohal",title:"Senior Analyst",from:"2012-10-01",to:"2014-10-11",description:"",default_item:!1},{type:"Work",institution:"Gulf Researcher","class":"gulfresearcher",title:"Temporary Senior Research Analyst",from:"2015-01-01",to:"2015-02-11",description:"",default_item:!1},{type:"Work",institution:"Starcom MediaVest Group","class":"starcom",title:"Senior Analyst",from:"2015-02-15",to:"2015-03-31",description:"",default_item:!0},{type:"Work",institution:"MediaCom","class":"mediacom",title:"Senior Analyst",from:"2015-04-13",to:null,description:"",default_item:!0}],[{type:"Study",institution:"University of York","class":"york",title:"Bachelors of Economics",from:"2008-10-13",to:"2011-07-10",description:"",default_item:!1},{type:"Study",institution:"University of Warwick","class":"warwick",title:"Msc in Economics and International Financial Economics",from:"2011-09-01",to:"2013-03-01",description:"",default_item:!1},{type:"Study",institution:"University of Essex","class":"essex",title:"Agent-based Modelling Course",from:"2014-07-01",to:"2014-07-10",description:"",default_item:!1},{type:"Study",institution:"Stanford University","class":"stanford",title:"Mining of Massive Datasets and Machine Learning",from:"2014-09-01",to:"2014-12-12",description:"",default_item:!1}]],init=function(){var t="0 0 960 500",e="xMidYMid",i=document.getElementById("cv-vis").offsetWidth-20,a=500,o=d3.select("body").select("#cv-vis").append("svg").attr("width",i).attr("height",a).attr("viewBox",t).attr("preserveAspectRatio",e),n=d3.time.scale().domain([new Date(2008,7,1),new Date]).range([0,960]),r=d3.svg.axis().scale(n).orient("bottom").tickFormat(d3.time.format("%b %Y")),s=o.append("g").attr("class","graph-container").attr("transform","translate("+[0,a/3]+")");s.append("g").attr("class","x axis").call(r),data.forEach(function(t,e){var i=["work","study"],a=[-1,1],o=[d3.scale.category10(),d3.scale.category10()];normalize(t),calculateDiameter(t,n),drawPaths(s,t,i[e],a[e],n,o[e])})};init();